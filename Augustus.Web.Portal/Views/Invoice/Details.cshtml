@model Invoice
@{
    ViewBag.Title = Model.Name;
}

<ol class="breadcrumb">
    <li><a class="hidden-xs" href="@Url.Action("ActiveAccounts", "Organization")">True Clarity</a><span class="visible-xs">...</span></li>
    <li>@Html.ActionLink(Model.Account.Name, "Invoices", "Account", new { id = Model.Account.Id }, null)</li>
    <li>@Html.ActionLink(Model.Opportunity.Name, "Invoices", "Opportunity", new { id = Model.Opportunity.Id }, null)</li>
</ol>

<div class="row">
    <div class="col-md-4">
        <div class="list-group">
            <div class="list-group-item">
                <div class="row">
                    <div class="col-xs-6"><strong>Margin</strong></div>
                    <div class="col-xs-6 text-right">@CurrencyHelper.Format(Model.Margin)</div>
                </div>
            </div>
            <div class="list-group-item">
                <div class="row">
                    <div class="col-xs-6"><strong>Cost</strong></div>
                    <div class="col-xs-6 text-right">@CurrencyHelper.Format(Model.Cost)</div>
                </div>
            </div>
            <div class="list-group-item">
                <div class="row">
                    <div class="col-xs-6"><strong>Revenue</strong></div>
                    <div class="col-xs-6 text-right">@CurrencyHelper.Format(Model.Revenue)</div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="list-group">
            <div class="list-group-item">
                <div class="row">
                    <div class="col-xs-6"><strong>Proposal Date</strong></div>
                    <div class="col-xs-6 text-right"></div>
                </div>
            </div>
            <div class="list-group-item">
                <div class="row">
                    <div class="col-xs-6"><strong>SDN Date</strong></div>
                    <div class="col-xs-6 text-right"></div>
                </div>
            </div>
            <div class="list-group-item">
                <div class="row">
                    <div class="col-xs-6"><strong>Invoice Date</strong></div>
                    <div class="col-xs-6 text-right">@DateTimeHelper.Format(Model.InvoiceDate)</div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="list-group">

            <div class="list-group-item">
                <div class="row">
                    <div class="col-xs-6"><strong>PO No.</strong></div>
                    <div class="col-xs-6 text-right">@Model.PONumber</div>
                </div>
            </div>
            <div class="list-group-item">
                <div class="row">
                    <div class="col-xs-6"><strong>Invoice No.</strong></div>
                    <div class="col-xs-6 text-right">@Model.InvoiceNo</div>
                </div>
            </div>
            <div class="list-group-item">
                <div class="row">
                    <div class="col-xs-6">@Html.LabelFor(m => m.Status)</div>
                    <div class="col-xs-6 text-right">@Html.DisplayFor(m => m.Status)</div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="panel panel-default">
    <div class="panel-heading">Work Done</div>
    <div class="table-responsive">
        <table class="table">
            <thead>
                <tr>
                    <th>Date</th>
                    <th class="currency">Margin</th>
                </tr>
            </thead>
            @foreach (var i in Model.WorkDoneItems)
            {
                <tr>
                    <td>@DateTimeHelper.Format(i.WorkDoneDate)</td>
                    <td class="currency">@CurrencyHelper.Format(i.Margin)</td>
                </tr>
            }
            <tfoot>
                <tr>
                    <td>Total</td>
                    <td class="currency">@CurrencyHelper.Format(Model.WorkDoneItems.Sum(i => i.Margin))</td>
                </tr>
            </tfoot>
        </table>
    </div>
</div>

<div>
    <a class="btn btn-default" target="_blank" href="https://trueclarity4.crm4.dynamics.com/main.aspx?etc=10010&id={@Model.Id}&pagetype=entityrecord">Open in CRM</a>
    <a class="btn btn-default pull-right" href="@Url.Action("Edit", new { id = Model.Id })">Edit Invoice</a>
</div>
